<!DOCTYPE html>
<html>
<head>
	<title>Password Generator</title>
	{% include 'components/meta.html.j2' %}
	<link rel="stylesheet" href="/static/css/generaltool.css">
</head>
<body>
	{% include 'components/header.html.j2' %}

    <div class="toolInfo">
        <h1 class="toolTitle">Password Generator</h1>
        <p class="toolDescription">
        Create a perfect password in seconds. Use a different password for every service you use for maximum security.
        </p>
    </div>

    <div class="toolContainer">
        <p>Password length: <span id="passwordLengthText">16</span></p>
        <input type="range" min="1" max="64" value="16" id="passwordLength">
        <br>
        <p>Lowercase characters (a-z):</p>
        <input type="checkbox" checked="true" id="lowercaseCharacters">
        <br>
        <p>Uppercase characters (A-Z):</p>
        <input type="checkbox" checked="true" id="uppercaseCharacters">
        <br>
        <p>Numbers (0-9):</p>
        <input type="checkbox" checked="true" id="numericCharacters">
        <br>
        <p>Special Characters:</p>
        <input type="checkbox" checked="true" id="specialCharacters">

        <hr>

        <p id="entropyLevel" class="feedback"></p>
        <input type="text" id="passwordOutput">

        <br>

    </div>
    <script>
        function $(e) {return document.getElementById(e)};

        $('passwordLength').oninput = generate;
        $('lowercaseCharacters').oninput = generate;
        $('uppercaseCharacters').oninput = generate;
        $('numericCharacters').oninput = generate;
        $('specialCharacters').oninput = generate;

        const alphabet = 'abcdefghijklmnopqrstuvwxyz';
        const numbers = '0123456789'
        const special = "~`! @#$%^&*()_-+={[}]|\:;'<,>.?/"

        function generate() {
            let characterPool = '';
            const passwordLength = $('passwordLength').value;

            $('passwordLengthText').innerText = passwordLength;

            // Fill the pool based on what was selected
            if ($('lowercaseCharacters').checked) {
                characterPool += alphabet
            };
            if ($('uppercaseCharacters').checked) {
                characterPool += alphabet.toUpperCase()
            };
            if ($('numericCharacters').checked) {
                characterPool += numbers;
            }
            if ($('specialCharacters').checked) {
                characterPool += special;
            }

            // No characters in pool
            if (characterPool.length === 0) {
                $('passwordOutput').value = ':(';
                return;
            }

            // Generate the password based on length and the character pool
            let generatedPassword = '';
            for (let i = 0; i < passwordLength; i ++) {
                const char = characterPool[Math.floor(Math.random() * characterPool.length)];
                generatedPassword += char;
            };

            $('passwordOutput').value = generatedPassword;

            const entropy = characterPool.length ** passwordLength;

            let color = '#000000';
            let text = '';
            if (entropy < 100_000_000) {
                color = '#FF0000';
                text = 'Terrible';
            } else if (entropy < 100_000_000_000_000) {
                color = '#FF8800';
                text = 'Bad';
            } else if (entropy < 100_000_000_000_000_000_000) {
                color = '#FFFF00';
                text = 'Okay';
            } else if (entropy < 100_000_000_000_000_000_000_000_000) {
                color = '#88FF00';
                text = 'Good';
            } else if (entropy < 100_000_000_000_000_000_000_000_000_000_000) {
                color = '#44FF00';
                text = 'Very Good';
            } else {
                color = '#00FFFF';
                text = 'Uncrackable';
            }
            $('entropyLevel').style.borderLeft = `5px solid ${color}`;
            $('entropyLevel').innerText = text;
        }
        generate();
    </script>
  	
  	{% include "components/footer.html.j2" %}
</body>
</html>